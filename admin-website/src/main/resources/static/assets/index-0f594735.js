import{d as h,r as D,a8 as N,u as v,v as g,w as a,l as t,H as s,W as e,J as b,E as p,Z as O,_ as E,k as F}from"./vue-fdfdc7c1.js";import{h as R,I as G,B as M,_ as x}from"./index-c4332e9f.js";import{R as H,C as _,a as n,G as u}from"./index-28317ab8.js";import{D as L}from"./index-ae7dd371.js";import{F as f,a as U}from"./index-8fd4ffea.js";import"./index-ddfb43e7.js";import{G as q}from"./index-76703bb7.js";import{u as z,N as J}from"./loading-bee91100.js";import"./chevron-up-b5845a28.js";import"./index-259f1314.js";import"./index-3f7c73bb.js";import"./index-c16e23f7.js";import"./warning-triangle-d6fdd716.js";function P(d){return R({url:"/api/admin/v1/scb/admin/observability/searchTrace",params:{timestamp:d.timestamp,traceId:d.traceId}})}const y=d=>(O("data-v-12046815"),d=d(),E(),d),W={class:"main"},Y=y(()=>a("div",{class:"main-title"},[a("span"),a("p",null,"调用链搜索")],-1)),Z={class:"main-content"},j={class:"main-content-form"},A={class:"main-content-search"},K={class:"main-list"},Q=y(()=>a("div",null,[a("span",{class:"list-operation"},"查看日志"),b(" | "),a("span",{class:"list-operation"},"查看Metrics")],-1)),X=h({__name:"main",setup(d){const m=D(),{loading:w,setLoading:c}=z(),I=({code:l,$grid:o})=>{switch(l){case"clearRowExpand":{o.clearRowExpand();break}}},B=l=>{const o=new Date(l/1e3),r=o.getFullYear(),C=String(o.getMonth()+1),k=String(o.getDate()),T=String(o.getHours()),V=String(o.getMinutes()),$=String(o.getSeconds());return`${r}-${C}-${k} ${T}:${V}:${$}`},i=N({filterOptions:{},traceData:{},toolbarButtons:[{code:"clearRowExpand",name:"手动清空展开行状态"}]}),S=()=>{c(!0);try{P({timestamp:i.filterOptions.startTime,traceId:i.filterOptions.traceId}).then(l=>{i.traceData=l.data},l=>{console.log("错误",l.message)})}catch{J({type:"error",title:"search error",message:"search error",position:"top-right",duration:2e3,customClass:"my-custom-cls"})}finally{c(!1)}};return(l,o)=>(v(),g("div",W,[Y,a("div",Z,[a("div",j,[t(e(U),{ref_key:"searchForm",ref:m,"label-width":"100px",class:"demo-form"},{default:s(()=>[t(e(H),null,{default:s(()=>[t(e(_),{span:6},{default:s(()=>[t(e(f),{label:"Trace-Id:"},{default:s(()=>[t(e(G),{modelValue:i.filterOptions.traceId,"onUpdate:modelValue":o[0]||(o[0]=r=>i.filterOptions.traceId=r)},null,8,["modelValue"])]),_:1})]),_:1}),t(e(_),{span:6},{default:s(()=>[t(e(f),{label:"大概时间:"},{default:s(()=>[t(e(L),{modelValue:i.filterOptions.startTime,"onUpdate:modelValue":o[1]||(o[1]=r=>i.filterOptions.startTime=r)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},512)]),a("div",A,[t(e(M),{type:"primary",onClick:S},{default:s(()=>[b("搜索")]),_:1})])]),a("div",K,[t(e(u),{resizable:"","seq-serial":"",data:i.traceData,onToolbarButtonClick:I},{toolbar:s(()=>[t(e(q),{buttons:i.toolbarButtons},null,8,["buttons"])]),default:s(()=>[t(e(n),{type:"index",width:"60"}),t(e(n),{width:"60"}),t(e(n),{type:"expand",title:"data",width:"60"},{default:s(r=>[t(e(u),{data:r.row.data},{default:s(()=>[t(e(n),{field:"name",title:"name","show-overflow":""}),t(e(n),{field:"duration",title:"duration"}),t(e(n),{field:"traceId",title:"http.status_code"},{default:s(()=>[a("template",null,[a("div",null,p(r.row.tags["http.status_code"]),1)])]),_:2},1024),t(e(n),{field:"timestamp",title:"timestamp"},{default:s(()=>[a("template",null,[a("div",null,p(B(r.row.timestamp)),1)])]),_:2},1024)]),_:2},1032,["data"])]),_:1}),t(e(n),{field:"application",title:"application"}),t(e(n),{field:"instanceId",title:"instanceId"}),t(e(n),{field:"localhost",title:"localhost"}),t(e(n),{field:"serviceName",title:"serviceName"}),t(e(n),{title:"操作",width:"150"},{default:s(()=>[Q]),_:1})]),_:1},8,["data"])])]))}});const tt=x(X,[["__scopeId","data-v-12046815"]]),et={class:"container"},at={class:"contain"},st=h({__name:"index",setup(d){return(m,w)=>{const c=F("Breadcrumb");return v(),g("div",et,[a("div",at,[t(c,{items:["menu.cloud","menu.cloud.locate.problems"]}),t(tt)])])}}});const vt=x(st,[["__scopeId","data-v-e19f70fa"]]);export{vt as default};
